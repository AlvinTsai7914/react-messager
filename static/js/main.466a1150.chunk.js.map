{"version":3,"sources":["components/App/App.js","index.js"],"names":["Page","styled","div","Title","h1","MessageForm","form","MessageNickname","input","MessageTextArea","textarea","SubmitButton","button","MessageList","MessageContainer","MessageHead","MessageAuthor","MessageTime","MessageBody","ErrorMessage","Loading","Message","author","time","children","App","useState","messages","setMessages","messageApiError","setMessageApiError","nickname","body","value","setValue","postMessageError","setPostMessageError","isLoadingPostMessage","setIsLoadingPostMessage","fetchMessage","fetch","then","res","json","data","catch","err","message","handleInputChange","e","target","name","handleInputFocus","useEffect","onSubmit","preventDefault","method","headers","JSON","stringify","ok","onChange","onFocus","rows","toString","length","map","Date","createdAt","toLocaleString","id","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.466a1150.chunk.js","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport styled from 'styled-components';\nimport PropTypes from 'prop-types';\n\nconst API_ENDPOINT = 'https://student-json-api.lidemy.me/comments?_sort=createdAt&_order=desc';\n\nconst Page = styled.div`\n  width: 360px;\n  margin: 0 auto;\n`;\n\nconst Title = styled.h1`\n  color: #333;\n`;\nconst MessageForm = styled.form``;\n\nconst MessageNickname = styled.input``;\n\nconst MessageTextArea = styled.textarea`\n  display: block;\n  width: 100%;\n  margin-top: 8px;\n`;\n\nconst SubmitButton = styled.button`\n  margin-top: 8px;\n`;\n\nconst MessageList = styled.div`\n  margin-top: 16px;\n`;\n\nconst MessageContainer = styled.div`\n  border: 1px solid black;\n  padding: 8px 16px;\n  border-radius: 8px;\n\n  & + & {\n    margin-top: 8px;\n  }\n`;\n\nconst MessageHead = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.3);\n  padding-bottom: 4px;\n`;\n\nconst MessageAuthor = styled.div`\n  color: #00739a;\n  font-size: 14px;\n`;\nconst MessageTime = styled.div``;\nconst MessageBody = styled.div`\n  font-size: 16px;\n  margin-top: 16px;\n`;\nconst ErrorMessage = styled.div`\n  margin-top: 16px;\n  color: red;\n`;\n\nconst Loading = styled.div`\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.5);\n  color: white;\n  font-size: 30px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n`;\n\nfunction Message({ author, time, children }) {\n  return (\n    <MessageContainer>\n      <MessageHead>\n        <MessageAuthor>{author}</MessageAuthor>\n        <MessageTime>{time}</MessageTime>\n      </MessageHead>\n      <MessageBody>{children}</MessageBody>\n    </MessageContainer>\n  );\n}\n\nMessage.propTypes = {\n  author: PropTypes.string,\n  time: PropTypes.string,\n  children: PropTypes.node,\n};\n\nfunction App() {\n  const [messages, setMessages] = useState(null);\n  const [messageApiError, setMessageApiError] = useState(null);\n  const [value, setValue] = useState({ nickname: '', body: '' });\n  const [postMessageError, setPostMessageError] = useState();\n  const [isLoadingPostMessage, setIsLoadingPostMessage] = useState(false);\n\n  const fetchMessage = () => {\n    return fetch(API_ENDPOINT)\n      .then((res) => res.json())\n      .then((data) => {\n        setMessages(data);\n      })\n      .catch((err) => {\n        setMessageApiError(err.message);\n      });\n  };\n\n  const handleInputChange = (e) => {\n    setValue({ ...value, [e.target.name]: e.target.value });\n  };\n\n  // const handleTextAreaChange = (e) => {\n  //   setValue({ ...value, [e.target.name]: e.target.value });\n  // };\n\n  const handleInputFocus = (e) => {\n    setPostMessageError(null);\n  };\n\n  const handleFormSubmit = (e) => {\n    e.preventDefault();\n    if (isLoadingPostMessage) {\n      return;\n    }\n    let { nickname, body } = value;\n    setIsLoadingPostMessage(true);\n    fetch('https://student-json-api.lidemy.me/comments', {\n      method: 'POST',\n      headers: {\n        'content-type': 'application/json',\n      },\n      body: JSON.stringify({\n        nickname,\n        body,\n      }),\n    })\n      .then((res) => res.json())\n      .then((data) => {\n        setIsLoadingPostMessage(false);\n        if (data.ok === 0) {\n          setPostMessageError(data.message);\n          return;\n        }\n        setValue({ nickname: '', body: '' });\n        fetchMessage();\n      })\n      .catch((err) => {\n        setIsLoadingPostMessage(false);\n        setPostMessageError(err.message);\n      });\n  };\n\n  useEffect(() => {\n    fetchMessage();\n  }, []);\n\n  return (\n    <Page>\n      {isLoadingPostMessage && <Loading>Loading...</Loading>}\n      <Title>留言板</Title>\n      <MessageForm onSubmit={handleFormSubmit}>\n        暱稱：\n        <MessageNickname\n          name=\"nickname\"\n          value={value.nickname}\n          onChange={handleInputChange}\n          onFocus={handleInputFocus}\n        />\n        <MessageTextArea\n          name=\"body\"\n          value={value.body}\n          onChange={handleInputChange}\n          onFocus={handleInputFocus}\n          rows={10}\n        />\n        <SubmitButton>送出</SubmitButton>\n        {postMessageError && <ErrorMessage>{postMessageError}</ErrorMessage>}\n      </MessageForm>\n      {messageApiError && <ErrorMessage>Something went wrong. {messageApiError.toString()}</ErrorMessage>}\n      {messages && messages.length === 0 && <div>no message</div>}\n      <MessageList>\n        {messages &&\n          messages.map((message) => {\n            return (\n              <Message key={message.id} author={message.nickname} time={new Date(message.createdAt).toLocaleString()}>\n                {message.body}\n              </Message>\n            );\n          })}\n      </MessageList>\n    </Page>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './components/App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}